const post = document.querySelector('#post');const postCounter = document.querySelectorAll('.postcounter')[0];const preview = document.querySelectorAll('.preview')[0];let map = {};let images;post.addEventListener('keydown', (e) => {map[e.key] = true;if( map['Control'] && e.key === 'Enter') {postCheck();workFlow('Input Menggunakan Komputer');}if(e.key === 'p') workFlow();setTimeout(() => {document.querySelector('.raw-output').innerHTML = convertValue(post.value);;charCounter()}, 200);});post.addEventListener('keyup', (e) => {delete map[e.key];});function postCheck() {if(post) {(preview) ? preview.innerHTML = convertValue(post.value) : console.error( 'container with the class of \'.preview\' doesn\'t exist.');images = preview.querySelectorAll('image');} else {console.error('\'container with the id of \'#post\' doesn\'t exist.');}}function convertValue(text) {let arr = text.match(/\[.*?\]|\[imgs=\]/g);const arrStore = text.match(/\[.*?\]|\[imgs=\]/g);text = htmlInjectionIncoder(text);if(arr) {arr.forEach(convertCase);for(let i = 0; i < arrStore.length; i++) {text = text.split(arrStore[i]).join(arr[i]);}}return arrayToString(text);}function arrayToString(y) {return y.toString().replace(/,(?!,)/g, " ");}function htmlInjectionIncoder(y) {return y.replace(/(<script(\s|\S)*?<\/script>)|(<style(\s|\S)*?<\/style>)|(<!--(\s|\S)*?-->)|(<\/?(\s|\S)*?>)/g, " ");}function charCounter() {let maxChar = 140; let arr = post.value.split("");postCounter.innerHTML = maxChar - arr.length;if(arr.length > maxChar) {postCounter.style.color = "red";post.style.color = "#cececece";} else {postCounter.style.color = "";post.style.color = "";}}function convertCase(item, i, arr) {let url;let locationSlice = item.search(':');if(locationSlice === -1) locationSlice = item.search('=');let tag = item.slice(1, locationSlice);tag = tag.toLowerCase();let x = item.slice(locationSlice+1, item.length-1);if(tag === "br" || tag === "hr") {arr[i] = "<"+tag+"/>";}else if(tag === "imgs=https" || tag === "imgs=http" || tag === "imgs") {locationSlice= item.search('='); url = item.slice(locationSlice+1, item.length-1);tag = item.slice(1, locationSlice-1);tag = tag.toLowerCase();arr[i] = "<"+tag+" class=\"preview-image\" src=\""+url+"\"/>";}else if(tag === "video=https" || tag ==="video=http" || tag === "video" ) {locationSlice= item.search('='); url = item.slice(locationSlice+1, item.length-1);source = "<source src="+url+">";arr[i] = "<"+tag+" class=\"preview-video\" autoplay nocontrols>"+source+"Your browser does not support the video tag."+"</"+tag+">";}else if(locationSlice === -1) {x = item.slice(1, item.length-1);arr[i] = x;} else {arr[i] = "<"+tag+">"+x+"</"+tag+">";}}let wi = 1;function workFlow(x) {let logsArea = document.querySelector('.log-area');if(x) newLogBase(x, logsArea);}function newLogBase(x, y) {let logBase = document.createElement('div');logBase.classList.add('lognew');if(x) logBase.innerHTML = "["+wi+"]: "+x;y.appendChild(logBase);wi++;}function biggerImage() {console.log(images);}function copyItem() {let x = document.querySelector('.raw-output');if(x.value) {navigator.clipboard.writeText(x.value);}}